2025-10-18 20:30:26,875:INFO:root:process_cowrie.py:initialize_database:Database initializing...
2025-10-18 20:30:26,876:DEBUG:root:process_cowrie.py:db_commit:Database transaction committed
2025-10-18 20:30:26,876:INFO:root:process_cowrie.py:initialize_database:Hostname columns likely already exist...
Failure adding table columns, likely because they already exist...
2025-10-18 20:30:26,876:ERROR:root:process_cowrie.py:initialize_database:Failure adding table columns, likely because they already exist...
2025-10-18 20:30:26,877:ERROR:root:process_cowrie.py:initialize_database:Failure adding table columns, likely because they already exist...
2025-10-18 20:30:26,877:DEBUG:root:process_cowrie.py:db_commit:Database transaction committed
2025-10-18 20:30:26,877:INFO:root:process_cowrie.py:initialize_database:Database indexes ensured (IF NOT EXISTS)
2025-10-18 20:30:26,878:DEBUG:root:process_cowrie.py:db_commit:Database transaction committed
2025-10-18 20:30:26,878:DEBUG:root:process_cowrie.py:db_commit:Database transaction committed
============================= test session starts ==============================
platform linux -- Python 3.13.7, pytest-8.3.3, pluggy-1.6.0
rootdir: /home/speterson/cowrieprocessor
configfile: pytest.ini
plugins: cov-5.0.0
collected 114 items
INTERNALERROR> Traceback (most recent call last):
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 283, in wrap_session
INTERNALERROR>     session.exitstatus = doit(config, session) or 0
INTERNALERROR>                          ~~~~^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 336, in _main
INTERNALERROR>     config.hook.pytest_collection(session=session)
INTERNALERROR>     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
INTERNALERROR>     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
INTERNALERROR>            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
INTERNALERROR>     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
INTERNALERROR>            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
INTERNALERROR>     raise exception
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
INTERNALERROR>     teardown.throw(exception)
INTERNALERROR>     ~~~~~~~~~~~~~~^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/logging.py", line 790, in pytest_collection
INTERNALERROR>     return (yield)
INTERNALERROR>             ^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
INTERNALERROR>     teardown.throw(exception)
INTERNALERROR>     ~~~~~~~~~~~~~~^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/warnings.py", line 121, in pytest_collection
INTERNALERROR>     return (yield)
INTERNALERROR>             ^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
INTERNALERROR>     teardown.throw(exception)
INTERNALERROR>     ~~~~~~~~~~~~~~^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/config/__init__.py", line 1417, in pytest_collection
INTERNALERROR>     return (yield)
INTERNALERROR>             ^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
INTERNALERROR>     res = hook_impl.function(*args)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 347, in pytest_collection
INTERNALERROR>     session.perform_collect()
INTERNALERROR>     ~~~~~~~~~~~~~~~~~~~~~~~^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 809, in perform_collect
INTERNALERROR>     self.items.extend(self.genitems(node))
INTERNALERROR>     ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 975, in genitems
INTERNALERROR>     yield from self.genitems(subnode)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 975, in genitems
INTERNALERROR>     yield from self.genitems(subnode)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 970, in genitems
INTERNALERROR>     rep, duplicate = self._collect_one_node(node, handle_dupes)
INTERNALERROR>                      ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/main.py", line 835, in _collect_one_node
INTERNALERROR>     rep = collect_one_node(node)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 567, in collect_one_node
INTERNALERROR>     rep: CollectReport = ihook.pytest_make_collect_report(collector=collector)
INTERNALERROR>                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_hooks.py", line 512, in __call__
INTERNALERROR>     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
INTERNALERROR>            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_manager.py", line 120, in _hookexec
INTERNALERROR>     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
INTERNALERROR>            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 167, in _multicall
INTERNALERROR>     raise exception
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 139, in _multicall
INTERNALERROR>     teardown.throw(exception)
INTERNALERROR>     ~~~~~~~~~~~~~~^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/capture.py", line 860, in pytest_make_collect_report
INTERNALERROR>     rep = yield
INTERNALERROR>           ^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/pluggy/_callers.py", line 121, in _multicall
INTERNALERROR>     res = hook_impl.function(*args)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 391, in pytest_make_collect_report
INTERNALERROR>     call = CallInfo.from_call(
INTERNALERROR>         collect, "collect", reraise=(KeyboardInterrupt, SystemExit)
INTERNALERROR>     )
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 341, in from_call
INTERNALERROR>     result: TResult | None = func()
INTERNALERROR>                              ~~~~^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/runner.py", line 389, in collect
INTERNALERROR>     return list(collector.collect())
INTERNALERROR>                 ~~~~~~~~~~~~~~~~~^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/python.py", line 549, in collect
INTERNALERROR>     self._register_setup_module_fixture()
INTERNALERROR>     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/python.py", line 562, in _register_setup_module_fixture
INTERNALERROR>     self.obj, ("setUpModule", "setup_module")
INTERNALERROR>     ^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/python.py", line 284, in obj
INTERNALERROR>     self._obj = obj = self._getobj()
INTERNALERROR>                       ~~~~~~~~~~~~^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/python.py", line 546, in _getobj
INTERNALERROR>     return importtestmodule(self.path, self.config)
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/python.py", line 493, in importtestmodule
INTERNALERROR>     mod = import_path(
INTERNALERROR>         path,
INTERNALERROR>     ...<2 lines>...
INTERNALERROR>         consider_namespace_packages=config.getini("consider_namespace_packages"),mainloop: caught unexpected SystemExit!

INTERNALERROR>     )
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/pathlib.py", line 582, in import_path
INTERNALERROR>     importlib.import_module(module_name)
INTERNALERROR>     ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/.local/share/uv/python/cpython-3.13.7-linux-x86_64-gnu/lib/python3.13/importlib/__init__.py", line 88, in import_module
INTERNALERROR>     return _bootstrap._gcd_import(name[level:], package, level)
INTERNALERROR>            ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
INTERNALERROR>   File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
INTERNALERROR>   File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
INTERNALERROR>   File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
INTERNALERROR>   File "/home/speterson/cowrieprocessor/.venv/lib/python3.13/site-packages/_pytest/assertion/rewrite.py", line 184, in exec_module
INTERNALERROR>     exec(co, module.__dict__)
INTERNALERROR>     ~~~~^^^^^^^^^^^^^^^^^^^^^
INTERNALERROR>   File "/home/speterson/cowrieprocessor/tests/integration/test_process_cowrie_sqlalchemy2.py", line 10, in <module>
INTERNALERROR>     from process_cowrie import (
INTERNALERROR>     ...<23 lines>...
INTERNALERROR>     )
INTERNALERROR>   File "/home/speterson/cowrieprocessor/process_cowrie.py", line 2325, in <module>
INTERNALERROR>     sys.exit(0)
INTERNALERROR>     ~~~~~~~~^^^
INTERNALERROR> SystemExit: 0

============================= 16 warnings in 3.76s =============================
